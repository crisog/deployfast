---
title: "Next.js Instrumentation Setup"
description: "Complete observability with OpenTelemetry for Next.js"
framework: "nextjs"
type: "guide"
---

# Next.js Instrumentation Guide

Set up complete observability for your Next.js application using OpenTelemetry.

## 1. Install Dependencies

```bash
npm install @opentelemetry/api @opentelemetry/sdk-node @opentelemetry/auto-instrumentations-node
```

## 2. Create instrumentation.ts

Create this file in your project root:

```typescript
export async function register() {
  if (process.env.NEXT_RUNTIME === 'nodejs') {
    const { NodeSDK } = await import('@opentelemetry/sdk-node')
    const { getNodeAutoInstrumentations } = await import('@opentelemetry/auto-instrumentations-node')

    const sdk = new NodeSDK({
      instrumentations: [getNodeAutoInstrumentations()],
      serviceName: process.env.OTEL_SERVICE_NAME || 'nextjs-app',
    })

    sdk.start()
  }
}
```

## 3. Environment Variables

Add these to your `.env.local`:

```env
OTEL_SERVICE_NAME=your-nextjs-app
OTEL_EXPORTER_OTLP_ENDPOINT=https://your-observability-endpoint
OTEL_EXPORTER_OTLP_HEADERS=authorization=Bearer your-token
```

## 4. Next.js Configuration

Update your `next.config.js`:

```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    instrumentationHook: true,
  },
  output: 'standalone', // Required for Docker
}

module.exports = nextConfig
```

## Benefits

- **Automatic instrumentation** for HTTP requests, database calls, and more
- **Distributed tracing** across your application
- **Performance monitoring** out of the box
- **Compatible** with observability platforms like Datadog, New Relic, and Grafana